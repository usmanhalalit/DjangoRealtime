{% for event in messages %}
<div class="mb-4" id="message-{{ event.id }}">
    <div class="flex items-start gap-2">
        <span class="text-3xl flex-shrink-0">ğŸ‘¤</span>
        <div class="flex-1">
            <div class="flex items-center gap-2 mb-1">
                <span class="font-black {% if event.detail.username == current_user.username %}text-green-600{% else %}text-blue-600{% endif %} truncate">
                    {{ event.detail.username }}
                </span>
                <span class="text-xs text-gray-500 flex-shrink-0">{{ event.created_at|date:"g:i A" }}</span>
            </div>
            <div class="border-4 {% if event.detail.username == current_user.username %}border-green-400 bg-green-50{% else %}border-blue-400 bg-blue-50{% endif %} p-3 shadow-md max-w-full min-w-0">
                <p class="break-all whitespace-pre-wrap">{{ event.detail.message|slice:":160" }}</p>
            </div>
        </div>
    </div>
</div>
{% empty %}
<div class="text-center p-8 text-gray-500" id="no-messages">
    <p class="text-2xl mb-2">ğŸ’¬</p>
    <p class="font-bold">No messages here. Say hello!</p>
</div>
{% endfor %}

{% if next_offset %}
<div
        class="text-center p-2 text-gray-500 text-sm"
        hx-get="{% url 'chatroom:get_messages' %}?offset={{ next_offset }}"
        hx-trigger="intersect once"
        hx-swap="outerHTML"
>
    <span class="animate-pulse">Loading older messages...</span>
</div>
{% endif %}